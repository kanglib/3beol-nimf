#
# PKGBUILD
# This file is part of Nimf.
#
# Copyright (C) 2018 Hodong Kim <cogniti@gmail.com>
#
# Nimf is free software: you can redistribute it and/or modify it
# under the terms of the GNU Lesser General Public License as published
# by the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# Nimf is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
# See the GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License
# along with this program;  If not, see <http://www.gnu.org/licenses/>.
#

pkgname=nimf
pkgver=master
pkgrel=1
pkgdesc="Nimf is an input method framework."
arch=('any')
url="https://gitlab.com/nimf-i18n/nimf"
license=('LGPL3')
makedepends=('binutils' 'autoconf' 'automake' 'gcc' 'make' 'glib2' 'intltool'
             'gtk3' 'gtk2' 'qt4' 'qt5-base' 'libappindicator-gtk3' 'librsvg'
             'noto-fonts-cjk' 'libhangul' 'anthy' 'libchewing' 'librime'
             'libxkbcommon' 'wayland' 'audit')
depends=('glib2' 'gtk3' 'gtk2' 'qt4' 'qt5-base' 'libappindicator-gtk3'
         'libhangul' 'anthy' 'libchewing' 'librime' 'libxkbcommon' 'wayland'
         'audit')
optdepends=('brise: Rime schema repository'
            'noto-fonts-cjk: Google Noto CJK fonts'
            'xorg-setxkbmap: Set the keyboard using the X Keyboard Extension')
source=("https://gitlab.com/nimf-i18n/nimf/-/archive/master/nimf-master.tar.bz2")
md5sums=('SKIP')

pkgver() {
	cd "$srcdir/nimf-master"
	grep AC_INIT configure.ac | grep -Po '\d{4}.\d{2}.\d{2}'
}

build() {
	cd "$srcdir/nimf-master"
	./autogen.sh --prefix=/usr
	make
}

package() {
	cd "$srcdir/nimf-master"
	make DESTDIR="${pkgdir}/" install
}
